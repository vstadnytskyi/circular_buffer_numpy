<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Usage &mdash; Numpy array circular buffer 0.2.0.post18+g4da57f4 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/plot_directive.css" type="text/css" />
      <link rel="stylesheet" href="_static/copybutton.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
        <script src="_static/clipboard.min.js"></script>
        <script src="_static/copybutton.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="The Circular Buffer Class Details" href="circular-buffer-class-details.html" />
    <link rel="prev" title="Theory of Operation" href="theory-of-operation.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> Numpy array circular buffer
          </a>
              <div class="version">
                0.2.0.post18+g4da57f4
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="theory-of-operation.html">Theory of Operation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Usage</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#the-circular-buffer">The Circular Buffer</a></li>
<li class="toctree-l2"><a class="reference internal" href="#the-queue-class">The Queue Class</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="circular-buffer-class-details.html">The Circular Buffer Class Details</a></li>
<li class="toctree-l1"><a class="reference internal" href="queue-class-details.html">The Queue Class Details</a></li>
<li class="toctree-l1"><a class="reference internal" href="release-history.html">Release History</a></li>
<li class="toctree-l1"><a class="reference internal" href="min_versions.html">Minimum Version of Python and NumPy</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Numpy array circular buffer</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Usage</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/usage.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="usage">
<h1>Usage<a class="headerlink" href="#usage" title="Permalink to this heading">¶</a></h1>
<p>In this section you will:</p>
<ul class="simple">
<li><p>Learn how to create your first circular buffer and perform simple operations with it.</p></li>
<li><p>Learn how to create your first queue buffer and perform simple operations with it.</p></li>
<li><p>Learn few example on when to use circular buffer and when to use queue.</p></li>
</ul>
<section id="the-circular-buffer">
<h2>The Circular Buffer<a class="headerlink" href="#the-circular-buffer" title="Permalink to this heading">¶</a></h2>
<p>The circular buffer is a data structure that allows you to allocate part of memory to store data, quickly append data and retrieve data. Remember that the circular buffer has limited “length” and the data is overwritten when you append more data than it can hold. The naming of the buffer class properties are taken from numpy array names, hence it should be familiar to numpy array users.</p>
<p>First, let us import the “CircularBuffer” class and create our first circular buffer. In the example below, we create a circular buffer with “shape” 100 by 2, and ‘float64’ as type of stored data. The length of the buffer is 100 and each entry holds 2 values, for example (time, temperature).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="kn">from</span> <span class="nn">circular_buffer_numpy.circular_buffer</span> <span class="kn">import</span> <span class="n">CircularBuffer</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="n">buffer</span> <span class="o">=</span> <span class="n">CircularBuffer</span><span class="p">(</span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="n">dtype</span> <span class="o">=</span> <span class="s1">&#39;float64&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Now, we have an instance of circular buffer named buffer. Let us explore inner properties of the buffer.</p>
<ul class="simple">
<li><p>“shape” - total shape of the underlying numpy array</p></li>
<li><p>“length” - length of the buffer.</p></li>
<li><p>“data_shape” - size of the individual data point.</p></li>
<li><p>“pointer” - last known entry in the buffer. the very first value is “-1”</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">3</span><span class="p">]:</span> <span class="n">buffer</span><span class="o">.</span><span class="n">shape</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">3</span><span class="p">]:</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">4</span><span class="p">]:</span> <span class="n">buffer</span><span class="o">.</span><span class="n">length</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">4</span><span class="p">]:</span> <span class="mi">100</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">5</span><span class="p">]:</span> <span class="n">buffer</span><span class="o">.</span><span class="n">data_shape</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">5</span><span class="p">]:</span> <span class="p">(</span><span class="mi">2</span><span class="p">,)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">6</span><span class="p">]:</span> <span class="n">buffer</span><span class="o">.</span><span class="n">pointer</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">6</span><span class="p">]:</span> <span class="o">-</span><span class="mi">1</span>
</pre></div>
</div>
<p>Now, we have an instance of circular buffer named buffer and we know something about. Let us explore different operation that can be performed with the buffer.</p>
<p>First, let us create a test numpy array with the shape corresponding to “data_shape” of the buffer. Let us make a vector of length two and populate it with two values: current time and a random number. These two numbers represent one 2D  data point (number vs time). Remember! the data point in this circular buffer can be a numpy array on its’ own.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">7</span><span class="p">]:</span> <span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">empty</span><span class="p">,</span> <span class="n">random</span>
<span class="n">In</span> <span class="p">[</span><span class="mi">8</span><span class="p">]:</span> <span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">time</span>
<span class="n">In</span> <span class="p">[</span><span class="mi">9</span><span class="p">]:</span> <span class="n">data_point</span> <span class="o">=</span> <span class="n">empty</span><span class="p">(</span><span class="n">shape</span> <span class="o">=</span> <span class="n">buffer</span><span class="o">.</span><span class="n">data_shape</span><span class="p">)</span>
<span class="n">In</span> <span class="p">[</span><span class="mi">10</span><span class="p">]:</span> <span class="n">data_point</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
<span class="n">In</span> <span class="p">[</span><span class="mi">11</span><span class="p">]:</span> <span class="n">data_point</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">4096</span><span class="p">)</span>
</pre></div>
</div>
<p>The “data_point” represents a typical single data entry acquired from a data acquisition device. This data can be now appened to the circular buffer. We can examine the location of the last known entry in the buffer, which is “0” in our case since we added only one data point.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">12</span><span class="p">]:</span> <span class="n">buffer</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<span class="n">In</span> <span class="p">[</span><span class="mi">13</span><span class="p">]:</span> <span class="n">buffer</span><span class="o">.</span><span class="n">pointer</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">13</span><span class="p">]:</span> <span class="mi">0</span>
<span class="n">In</span> <span class="p">[</span><span class="mi">14</span><span class="p">]:</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
            <span class="n">data_point</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
            <span class="n">data_point</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">4096</span><span class="p">)</span>
            <span class="n">buffer</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data_point</span><span class="p">)</span>
</pre></div>
</div>
<p>Next, we can examine the content of the circular buffer. There are several build in methods to get data from the buffer.</p>
<ul class="simple">
<li><p>“get_data()” - returns all valid data in the buffer.</p></li>
<li><p>“get_last_N(N=5)” - returns last N entries in the circular buffer</p></li>
<li><p>“get_last_value()” - returns the very last known entry in the circular buffer</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">15</span><span class="p">]:</span> <span class="n">buffer</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">15</span><span class="p">]:</span>
<span class="n">array</span><span class="p">([[</span><span class="mf">1.61452783e+09</span><span class="p">,</span> <span class="mf">4.07500000e+03</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">1.61452783e+09</span><span class="p">,</span> <span class="mf">1.00600000e+03</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">1.61452788e+09</span><span class="p">,</span> <span class="mf">2.01400000e+03</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">1.61452788e+09</span><span class="p">,</span> <span class="mf">2.02300000e+03</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">1.61452788e+09</span><span class="p">,</span> <span class="mf">2.83000000e+03</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">1.61452788e+09</span><span class="p">,</span> <span class="mf">7.12000000e+02</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">1.61452788e+09</span><span class="p">,</span> <span class="mf">1.31900000e+03</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">1.61452788e+09</span><span class="p">,</span> <span class="mf">1.40500000e+03</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">1.61452788e+09</span><span class="p">,</span> <span class="mf">3.41600000e+03</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">1.61452788e+09</span><span class="p">,</span> <span class="mf">2.27000000e+02</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">1.61452788e+09</span><span class="p">,</span> <span class="mf">2.59000000e+02</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">1.61452788e+09</span><span class="p">,</span> <span class="mf">3.69000000e+03</span><span class="p">]])</span>

 <span class="n">In</span> <span class="p">[</span><span class="mi">16</span><span class="p">]:</span> <span class="n">buffer</span><span class="o">.</span><span class="n">get_last_N</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
 <span class="n">Out</span><span class="p">[</span><span class="mi">16</span><span class="p">]:</span>
 <span class="n">array</span><span class="p">([[</span><span class="mf">1.61452788e+09</span><span class="p">,</span> <span class="mf">1.40500000e+03</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">1.61452788e+09</span><span class="p">,</span> <span class="mf">3.41600000e+03</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">1.61452788e+09</span><span class="p">,</span> <span class="mf">2.27000000e+02</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">1.61452788e+09</span><span class="p">,</span> <span class="mf">2.59000000e+02</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">1.61452788e+09</span><span class="p">,</span> <span class="mf">3.69000000e+03</span><span class="p">]])</span>

  <span class="n">In</span> <span class="p">[</span><span class="mi">17</span><span class="p">]:</span> <span class="n">buffer</span><span class="o">.</span><span class="n">get_last_value</span><span class="p">()</span>
  <span class="n">Out</span><span class="p">[</span><span class="mi">17</span><span class="p">]:</span> <span class="n">array</span><span class="p">([[</span><span class="mf">1.61452788e+09</span><span class="p">,</span> <span class="mf">3.69000000e+03</span><span class="p">]])</span>
</pre></div>
</div>
</section>
<section id="the-queue-class">
<h2>The Queue Class<a class="headerlink" href="#the-queue-class" title="Permalink to this heading">¶</a></h2>
<p>The queue class has very similar functionality to the circular buffer class with few modifications. The valid entry in the queue can be read only once, when you retrieve the data from the queue, it is not available anymore. The class mimics performance of first in first out(FIFO) buffer.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="kn">from</span> <span class="nn">circular_buffer_numpy.queue</span> <span class="kn">import</span> <span class="n">Queue</span>
<span class="n">In</span> <span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="n">queue</span> <span class="o">=</span> <span class="n">Queue</span><span class="p">(</span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="n">dtype</span> <span class="o">=</span> <span class="s1">&#39;float64&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Now, we have an instance of the Queue class named “queue”. Let us explore inner properties of the queue.</p>
<blockquote>
<div><ul class="simple">
<li><p>“shape” - total shape of the underlying numpy array</p></li>
<li><p>“length” - number of entried in the queue.</p></li>
<li><p>“data_shape” - size of the individual data point.</p></li>
<li><p>“rear” - the index in the underlying numpy array pointing at the next empty slot in the queue.</p></li>
<li><p>“global_rear” - the global index showing how many data points have been enqueued since the creation of the instance.</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<p>In [3]: queue.length
Out[3]: 0</p>
<p>In [4]: queue.shape
Out[4]: (100, 2)</p>
<p>In [5]: queue.data_shape
Out[5]: (2,)</p>
<p>In [6]: queue.rear
Out[6]: 0</p>
<p>In [7]: queue.global_rear
Out[7]: 0</p>
</div></blockquote>
<p>The “data_point” represents a typical single data entry acquired from a data acquisition device. This data can be now appended to the circular buffer. We can examine the location of the last known entry in the buffer, which is “0” in our case since we added only one data point.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="theory-of-operation.html" class="btn btn-neutral float-left" title="Theory of Operation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="circular-buffer-class-details.html" class="btn btn-neutral float-right" title="The Circular Buffer Class Details" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2017, Valentyn Stadnyskyi.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>